<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sleep & Food Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"></script>
  <style>
    .container {
      max-width: 900px;
      margin-top: 50px;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1 class="my-4 text-center">Sleep & Food Tracker</h1>

    <div class="row mb-3">
      <div class="col">
        <label for="date" class="form-label">Date</label>
        <input type="date" id="date" class="form-control">
      </div>
    </div>

    <!-- Sleep Tracker Section -->
    <div class="row mb-3">
      <div class="col">
        <label for="sleep-hours" class="form-label">Sleep Hours</label>
        <input type="number" id="sleep-hours" class="form-control" placeholder="Enter hours of sleep">
      </div>
    </div>

    <!-- Food Tracker Section -->
    <div class="row mb-3">
      <div class="col">
        <label for="food-calories" class="form-label">Calories Consumed</label>
        <input type="number" id="food-calories" class="form-control" placeholder="Enter calories">
      </div>
      <div class="col">
        <label for="meal-count" class="form-label">Number of Meals</label>
        <input type="number" id="meal-count" class="form-control" placeholder="How many meals today?">
      </div>
    </div>

    <!-- Nutrient Benefits Section -->
    <div class="row mb-3">
      <div class="col">
        <label for="food-benefits" class="form-label">Food Benefits (Manual)</label>
        <textarea id="food-benefits" class="form-control" placeholder="Enter the benefits of food (e.g., Vitamin A, Fiber, etc.)"></textarea>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label for="missing-benefits" class="form-label">Missing Nutrients</label>
        <textarea id="missing-benefits" class="form-control" placeholder="Enter missing nutrients (e.g., Vitamin C, Protein, etc.)"></textarea>
      </div>
    </div>

    <button class="btn btn-primary" id="save-btn">Save Data</button>

    <h3 class="mt-4">Visualizations</h3>
    <canvas id="sleep-chart" width="400" height="200"></canvas>
    <canvas id="meal-chart" width="400" height="200"></canvas>
    <canvas id="calories-chart" width="400" height="200"></canvas>

  </div>

  <script>
    // Save button click event handler
    document.getElementById("save-btn").addEventListener("click", saveData);

    function saveData() {
      let date = document.getElementById("date").value;
      let sleepHours = document.getElementById("sleep-hours").value;
      let foodCalories = document.getElementById("food-calories").value;
      let mealCount = document.getElementById("meal-count").value;
      let foodBenefits = document.getElementById("food-benefits").value;
      let missingBenefits = document.getElementById("missing-benefits").value;

      if (!date || !sleepHours || !foodCalories || !mealCount) {
        alert("Please fill all the fields!");
        return;
      }

      let data = {
        sleep: {
          hours: sleepHours,
          quality: sleepHours >= 7 ? "Good" : "Poor"
        },
        food: {
          calories: foodCalories,
          mealCount: mealCount,
          benefits: foodBenefits,
          missing: missingBenefits
        }
      };

      // Get current data from localStorage, or initialize if none exists
      let trackerData = JSON.parse(localStorage.getItem("trackerData")) || {};

      // Add/update the data for the selected date
      trackerData[date] = data;

      // Save the updated data to localStorage
      localStorage.setItem("trackerData", JSON.stringify(trackerData));

      alert("Data saved successfully!");

      // Update charts
      updateCharts(trackerData);
    }

    // Update charts based on saved data
    function updateCharts(trackerData) {
      let sleepLabels = [];
      let sleepData = [];
      let foodLabels = [];
      let foodData = [];
      let mealLabels = [];
      let mealData = [];

      for (let date in trackerData) {
        sleepLabels.push(date);
        sleepData.push(trackerData[date].sleep.hours);
        foodLabels.push(date);
        foodData.push(trackerData[date].food.calories);
        mealLabels.push(date);
        mealData.push(trackerData[date].food.mealCount);
      }

      let sleepCtx = document.getElementById('sleep-chart').getContext('2d');
      let caloriesCtx = document.getElementById('calories-chart').getContext('2d');
      let mealCtx = document.getElementById('meal-chart').getContext('2d');

      new Chart(sleepCtx, {
        type: 'line',
        data: {
          labels: sleepLabels,
          datasets: [{
            label: 'Sleep Hours',
            data: sleepData,
            borderColor: 'rgba(75, 192, 192, 1)',
            fill: false,
            tension: 0.1
          }]
        }
      });

      new Chart(caloriesCtx, {
        type: 'bar',
        data: {
          labels: foodLabels,
          datasets: [{
            label: 'Calories Consumed',
            data: foodData,
            backgroundColor: 'rgba(153, 102, 255, 0.2)',
            borderColor: 'rgba(153, 102, 255, 1)',
            borderWidth: 1
          }]
        }
      });

      new Chart(mealCtx, {
        type: 'bar',
        data: {
          labels: mealLabels,
          datasets: [{
            label: 'Meals Count',
            data: mealData,
            backgroundColor: 'rgba(255, 159, 64, 0.2)',
            borderColor: 'rgba(255, 159, 64, 1)',
            borderWidth: 1
          }]
        }
      });
    }

    // Initialize the charts on page load if there is data in localStorage
    window.onload = function() {
      let trackerData = JSON.parse(localStorage.getItem("trackerData")) || {};
      updateCharts(trackerData);
    }
  </script>

</body>
</html>
